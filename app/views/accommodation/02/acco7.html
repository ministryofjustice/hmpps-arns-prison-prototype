{% extends "layouts/main.html" %}

{% set pageName="Test" %}

{% block content %}
<div class="govuk-width-container" style="margin-top: -80px;">
  <main class="govuk-main-wrapper app-container govuk-body" id="main-content">
    <div class="govuk-width-container">
      <div class="govuk-grid-row user-feedback">
        <div class="govuk-grid-column-full">
          <div class="govuk-phase-banner user-feedback__banner">
            <p class="govuk-phase-banner__content">
              <strong class="govuk-tag govuk-phase-banner__content__tag">
                Beta
              </strong>
              <span class="govuk-phase-banner__text">
                This is a new service - your <a class="govuk-link user-feedback__link" href="#">feedback (opens in new tab)</a> will help us improve it.
              </span>
            </p>
          </div>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-full offender-details">
          <span style="color: #505A5F; margin: 10px 0; display: block;">
            CRN: X769773 | PNC: 01/17658481A | Date of birth: 02 October 1969
          </span>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; margin-top: 10px;">
            <h3 class="govuk-heading-m" style="margin-bottom: 0;">Alex Smith</h3>
            <a href="#" class="govuk-link print-link">View all answers</a>
          </div>
          <div id="assessment-info" class="govuk-visually-hidden" data-assessment-id="88b81aaa-7af7-49ed-8843-1fad974b3e72"></div>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
          <div class="form-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h1 class="govuk-heading-l form-header__title" style="margin-bottom: 0;">Strengths and needs</h1>
            <a href="#"
               role="button"
               draggable="false"
               class="govuk-button govuk-button--secondary"
               data-module="govuk-button"
               data-ai-id="return-to-oasys"
               id="return-to-oasys"
               style="margin-bottom: 0; margin-top: 2px;">
              Return to OASys
            </a>
          </div>
          <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible form-header_hr govuk-grid-column-full" style="margin-top: 10px;">
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-third">
          <nav class="moj-side-navigation" aria-label="Side navigation">
            <ul class="moj-side-navigation__list" style="padding-left: 0; list-style: none;">
              <li class="moj-side-navigation__item moj-side-navigation__item--active" style="background: #f3f2f1; font-weight: bold; border-left: 4px solid #1d70b8; margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" aria-current="location" class="govuk-link" tabindex="-1" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; font-weight: bold; cursor: default; pointer-events: none;">Accommodation</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Employment and education</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Finances</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Drug use</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Alcohol use</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Health and wellbeing</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Personal relationships and community</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Thinking, behaviours and attitudes</a>
              </li>
              <li class="moj-side-navigation__item" style="margin-bottom: 5px; padding: 8px 16px;">
                <a href="#" class="govuk-link" tabindex="0" aria-disabled="true" onclick="return false;" style="color: #1d70b8; text-decoration: none; cursor: pointer;">Offence analysis</a>
              </li>
            </ul>
          </nav>
        </div>
        <div class="govuk-grid-column-two-thirds">
          <div class="section-heading">
            <div class="section-heading__heading" style="display: flex; align-items: center; position: relative; width: 100%;">
              <h2 class="govuk-heading-l" style="margin-bottom: 0; margin-left: 0px;">Accommodation</h2>
              <strong class="govuk-tag govuk-tag--grey" style="position: absolute; right: 0; top: 50%; transform: translateY(-50%);">Incomplete</strong>
            </div>
          </div>
          <br>
          <div class="govuk-!-width-full">
            <!-- All tab content starts here -->
            <div class="govuk-tabs" data-module="govuk-tabs">
              <h2 class="govuk-tabs__title">Content</h2>
              <ul class="govuk-tabs__list" role="tablist">
                <li class="govuk-tabs__list-item govuk-tabs__list-item--selected" role="presentation">
                  <a class="govuk-tabs__tab" href="#summary" id="tab_summary" role="tab" aria-controls="summary" aria-selected="true" tabindex="0">Summary</a>
                </li>
                <li class="govuk-tabs__list-item" role="presentation">
                  <a class="govuk-tabs__tab" href="#practitioner-analysis" id="tab_practitioner-analysis" role="tab" aria-controls="practitioner-analysis" aria-selected="false" tabindex="-1">Practitioner analysis</a>
                </li>
              </ul>
              <div class="govuk-tabs__panel" id="summary" role="tabpanel" aria-labelledby="tab_summary">
                <form id="form" method="post">
                  <input type="hidden" name="x-csrf-token" value="EuxWnrI0-8q4EJzV1Hs00SUJbMxT4CGyrAbI">
                 
               


                  <dl class="govuk-summary-list summary-list">
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">What type of accommodation did Alex have before custody?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Settled</span>
                          </li>
                          <li class="summary-details-list">
                            <span class="summary__answer">Renting privately</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for What type of accommodation did Alex have before custody?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Who was Alex living with?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Partner</span>
                          </li>
                          <li class="summary-details-list">
                            <span class="summary__answer">This is an example of the details you would have added.</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Who was Alex living with?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Does Alex plan to return to this accommodation when they are released?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">No</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Does Alex plan to return to this accommodation when they are released?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Does Alex have new accommodation planned for when they are released?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Yes</span>
                          </li>
                          <li class="summary-details-list">
                            <span class="summary__answer">Living with friends or family</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Does Alex have new accommodation planned for when they are released?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Who is Alex planning on living with?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Family</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Who is Alex planning on living with?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Is the location of Alex's proposed accommodation suitable?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Yes</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Is the location of Alex's proposed accommodation suitable?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Is Alex’s proposed accommodation suitable?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">Yes</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Is Alex’s proposed accommodation suitable?</span></a>
                      </dd>
                    </div>
                    <div class="govuk-summary-list__row summary-list__row">
                      <dt class="govuk-summary-list__key summary-list__key">
                        <span class="summary__label">Does Alex want to make changes to their living arrangements when they are released?</span>
                      </dt>
                      <dd class="govuk-summary-list__value summary-list__value">
                        <ul class="govuk-list">
                          <li class="summary-details-list">
                            <span class="summary__answer">I want to make changes and know how to</span>
                          </li>
                        </ul>
                      </dd>
                      <dd class="govuk-summary-list__actions summary-list__actions">
                        <a class="govuk-link govuk-link--disabled" aria-disabled="true" tabindex="-1">Change<span class="govuk-visually-hidden">value for Does Alex want to make changes to their accommodation?</span></a>
                      </dd>
                    </div>
                  </dl>
                </form>
                <div class="questiongroup-action-buttons summary-action-buttons">
                  <a href="#practitioner-analysis" role="button" draggable="false" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-3" data-module="govuk-button" data-govuk-button-init="">
                    Go to practitioner analysis
                  </a>
                </div>
              </div>
              <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="practitioner-analysis" role="tabpanel" aria-labelledby="tab_practitioner-analysis">
                <form id="form" method="post" action="#practitioner-analysis" data-autosave="true" data-autosave-enabled="true">
                  <input type="hidden" name="x-csrf-token" value="EuxWnrI0-8q4EJzV1Hs00SUJbMxT4CGyrAbI">
                  <div class="govuk-form-group form-group ">
                    <fieldset class="govuk-fieldset">
                      <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">Are there any strengths or protective factors related to Alex's accommodation?</legend>
                      <div class="govuk-hint">Include any strategies, people or support networks that helped.</div>
                      <div class="govuk-radios" data-module="govuk-radios">
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_protective_yes" name="acco_protective" type="radio" value="YES" aria-controls="conditional-acco_protective_yes" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_protective_yes">Yes</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_protective_yes">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_protective_details_yes">Give details</label>
                            <textarea class="govuk-textarea" id="acco_protective_details_yes" name="acco_protective_details_yes" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,425 characters remaining</div>
                          </div>
                        </div>
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_protective_no" name="acco_protective" type="radio" value="NO" aria-controls="conditional-acco_protective_no" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_protective_no">No</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_protective_no">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_protective_details_no">Give details (optional)</label>
                            <textarea class="govuk-textarea" id="acco_protective_details_no" name="acco_protective_details_no" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,425 characters remaining</div>
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="govuk-form-group form-group ">
                    <fieldset class="govuk-fieldset">
                      <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">Is Alex's accommodation linked to risk of serious harm?</legend>
                      <div class="govuk-radios" data-module="govuk-radios">
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_seriousharm_yes" name="acco_seriousharm" type="radio" value="YES" aria-controls="conditional-acco_seriousharm_yes" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_seriousharm_yes">Yes</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_seriousharm_yes">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_seriousharm_details_yes">Give details</label>
                            <textarea class="govuk-textarea" id="acco_seriousharm_details_yes" name="acco_seriousharm_details_yes" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,425 characters remaining</div>
                          </div>
                        </div>
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_seriousharm_no" name="acco_seriousharm" type="radio" value="NO" aria-controls="conditional-acco_seriousharm_no" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_seriousharm_no">No</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_seriousharm_no">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_seriousharm_details_no">Give details (optional)</label>
                            <textarea class="govuk-textarea" id="acco_seriousharm_details_no" name="acco_seriousharm_details_no" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,425 characters remaining</div>
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="govuk-form-group form-group ">
                    <fieldset class="govuk-fieldset">
                      <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">Is Alex's accommodation linked to risk of reoffending?</legend>
                      <div class="govuk-radios" data-module="govuk-radios">
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_reoffending_yes" name="acco_reoffending" type="radio" value="YES" aria-controls="conditional-acco_reoffending_yes" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_reoffending_yes">Yes</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_reoffending_yes">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_reoffending_details_yes">Give details</label>
                            <textarea class="govuk-textarea" id="acco_reoffending_details_yes" name="acco_reoffending_details_yes" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,000 characters remaining</div>
                          </div>
                        </div>
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="acco_reoffending_no" name="acco_reoffending" type="radio" value="NO" aria-controls="conditional-acco_reoffending_no" aria-expanded="false">
                          <label class="govuk-label govuk-radios__label" for="acco_reoffending_no">No</label>
                        </div>
                        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-acco_reoffending_no">
                          <div class="govuk-form-group">
                            <label class="govuk-label" for="acco_reoffending_details_no">Give details (optional)</label>
                            <textarea class="govuk-textarea" id="acco_reoffending_details_no" name="acco_reoffending_details_no" rows="5"></textarea>
                            <div class="govuk-hint govuk-character-count__status" aria-live="polite">You have 1,000 characters remaining</div>
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="questiongroup-action-buttons">
                    <a href="acco7done#practitioner-analysis" class="govuk-button govuk-!-margin-bottom-3 govuk-!-margin-right-1" role="button" draggable="false" data-module="govuk-button" data-govuk-button-init="">
                      Mark as complete
                    </a>
                  </div>
                </form>
              </div>
            </div>
            <!-- All tab content ends here -->
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<style>
  /* Prevent line breaks in drug tickbox labels */
  .govuk-checkboxes__label {
    white-space: nowrap;
  }

  /* Reduce the left and right margins of the main container by 50% */
  .govuk-width-container {
    max-width: 1200px !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }

  /* Keep disabled links blue but non-clickable */
  .govuk-link--disabled[aria-disabled="true"] {
    color: #1d70b8 !important; /* GOV.UK blue */
    pointer-events: none;
    text-decoration: underline;
    cursor: default;
    opacity: 1;
  }

  /* Ensure active GOV.UK links are blue and show pointer on hover */
  a.govuk-link {
    color: #1d70b8;
    text-decoration: underline;
    cursor: pointer;
    transition: color 0.1s;
  }
  a.govuk-link:hover, a.govuk-link:focus {
    color: #003078;
    cursor: pointer;
  }

  /* Move the character count line up for all details textareas */
  textarea + .govuk-hint.govuk-character-count__status {
    margin-top: -20px;
    display: block;
  }
</style>

<script>
document.getElementById('form').addEventListener('submit', function(e) {
  e.preventDefault();
  // Always redirect to the specific URL for demonstration
  window.location.href = 'drug3?drugs=CANNABIS,HALLUCINOGENICS,HEROIN';
});

// Make all 'Change' links go to the correct page when clicked
function redirectChangeLinks() {
  document.querySelectorAll('a.govuk-link--disabled').forEach(function(link) {
    if (link.textContent.trim().startsWith('Change')) {
      link.removeAttribute('aria-disabled');
      link.removeAttribute('tabindex');
      link.classList.remove('govuk-link--disabled');
      link.addEventListener('click', function(e) {
        e.preventDefault();
        // Find the closest parent .govuk-tabs__panel to determine which tab
        var panel = link.closest('.govuk-tabs__panel');
        if (panel && panel.id === 'practitioner-analysis') {
          window.location.href = 'drug5#practitioner-analysis';
        } else {
          window.location.href = 'drug5';
        }
      });
    }
  });
}
document.addEventListener('DOMContentLoaded', redirectChangeLinks);

// Show the correct tab if #practitioner-analysis is in the URL
function showPractitionerAnalysisTabIfHash() {
  if (window.location.hash === '#practitioner-analysis') {
    var tabs = document.querySelector('.govuk-tabs');
    if (!tabs) return;
    // Remove selected class from all tab list items and panels
    tabs.querySelectorAll('.govuk-tabs__list-item').forEach(function(item) {
      item.classList.remove('govuk-tabs__list-item--selected');
    });
    tabs.querySelectorAll('.govuk-tabs__panel').forEach(function(panel) {
      panel.classList.add('govuk-tabs__panel--hidden');
    });
    // Add selected to the practitioner analysis tab and show its panel
    var paTab = document.getElementById('tab_practitioner-analysis');
    var paPanel = document.getElementById('practitioner-analysis');
    if (paTab && paPanel) {
      paTab.parentElement.classList.add('govuk-tabs__list-item--selected');
      paPanel.classList.remove('govuk-tabs__panel--hidden');
      paTab.setAttribute('aria-selected', 'true');
      paTab.setAttribute('tabindex', '0');
      var summaryTab = document.getElementById('tab_summary');
      if (summaryTab) {
        summaryTab.setAttribute('aria-selected', 'false');
        summaryTab.setAttribute('tabindex', '-1');
      }
    }
    // After 00.1s, scroll to the top to ensure Content is visible
    setTimeout(function() {
      window.scrollTo(0, 0);
    }, 10);
  }
}
document.addEventListener('DOMContentLoaded', showPractitionerAnalysisTabIfHash);

document.addEventListener('DOMContentLoaded', function() {
  var buttons = document.querySelectorAll('a.govuk-button[role="button"]');
  buttons.forEach(function(btn) {
    if (btn.textContent.trim() === 'Mark as complete') {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        window.location.href = 'acco8';
      });
    }
  });
});
</script>
{% endblock %}
